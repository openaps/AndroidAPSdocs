# Функции OpenAPS

(Open-APS-features-autosens)=

## Autosens

* Autosens-это алгоритм, который отслеживает отклонения ГК (позитивное/отрицательное/нейтральное).
* Он пытается определить, насколько вы чувствительны/резистентны на основании этих отклонений.
* Реализация oref в ** OpenAPS ** выполняется на основе комбинации данных за 24 и 8 часов. Он использует тот, который является более чувствительным.
* В версиях до AAPS 2.7 пользователю приходилось выбирать между 8 или 24 часами вручную.
* Начиная с AAPS 2.7 Autosens сам будет переключаться между 24 и 8 часами для вычисления чувствительности. Он выберет более чувствительный вариант. 
* Если пользователи перешли с oref1, они, вероятно, заметят, что система может быть менее динамичной из-за различий в 24 или 8 часах чувствительности.
* Замена канюли или изменение профиля сбросит Autosens назад на 100% (переключение профиля по процентам с установкой продолжительности не сбрасывает Autosens).
* Autosens настраивает базал и ISF ( примерно так же как изменение профиля в процентах).
* Если постоянно есть углеводы в течение длительного периода, не внося данные в систему, autosens будет менее эффективен в этот период, так как углеводы исключены из расчетов дельты ГК.

(Open-APS-features-super-micro-bolus-smb)=

## Супер микроболюс (SMB)

SMB, сокращение от 'супер микро болюс', является новой функцией OpenAPS (с 2018 года) в рамках алгоритма версии Oref1. В отличие от расширенного мастера болюса AMA, SMB не использует временные базалы для контроля уровнея ГК, вместо них применяются **микроболюсы**. Там, где алгоритм мастера болюса AMA добавит 1,0 ед. инсулина при помощb временной базальной скорости, SMB обеспечивает несколько супер микроболюсов маленькими шажками с **пятиминутным** интервалом, например 0,4; 0,3; 0,2; и 0,1 ед. В то же самое время (по соображениям безопасности) фактический базал устанавливается на 0 ед/ч на определенный период, чтобы предотвратить передозировку (т.н. **"нулевой базал"**). Это позволяет системе регулировать глюкозу крови быстрее, чем с временным повышением скорости базала в AMA.

Благодаря микроболюсам SMB для блюд, содержащих только "медленные" углеводы, достаточно сообщить системе о запланированном количестве углеводов, в остальном положившись на AAPS. Однако это может дать более высокие постпрандиальные (после приема пищи) пики, поскольку преболюс не вводился. Или, если нужен пре-болюс, можно ввести ** стартовый болюс**, который ** только частично** покрывает углеводы (например, 2/3 от расчетного количества), а остальное введут микроболюсы SMB.

Функция SMB содержит некоторые механизмы безопасности:

1. Самой большой однократной дозой SMB может быть только наименьшее значение от:
    
    * значения, соответствующего текущей базальной скорости (с поправками autosens) на длительность, установленную в "Максимуме минут базала, которыми ограничивается SMB", например, количество базального инсулина за следующие 30 минут, или
    * половина требуемого в данный момент количества инсулина, или
    * оставшаяся часть maxIOB в настройках.

2. Возможно, вы обратите внимание на частые низкие временные базалы (называемые "low temp") или временные базалы по 0 ед/ч (называемые "zero temp"). Это происходит по соображениям безопасности и не имеет отрицательных последствий, если профиль установлен правильно. Кривая активного инсулина более значима, чем линия временного базала.

3. Дополнительные расчеты для прогнозирования гликемии, (например, для непредвиденного приема прищи UAM). Даже без ручного ввода количества углеводов, UAM может автоматически определить значительное увеличение уровней ГК вследствие приема пищи, повышения адреналина или других факторов и попытаться компенсировать повышение при помощи SMB. Для безопасности, эта функция работает и в обратном направлении и может остановить подачу супер микроболюса при неожиданном понижении ГК. Поэтому функция UAM всегда должна быть активирована в алгоритме SMB.

**You must have started [objective 9](../SettingUpAaps/CompletingTheObjectives.md#objective-9-enabling-additional-oref1-features-for-daytime-use-such-as-super-micro-bolus-smb) to use SMB.**

См. также: [документацию OpenAPS по SMB в oref1](https://openaps.readthedocs.io/en/latest/docs/Customize-Iterate/oref1.html) и [информацию Tim'а по SMB](https://www.diabettech.com/artificial-pancreas/understanding-smb-and-oref1/).

(Open-APS-features-max-u-h-a-temp-basal-can-be-set-to-openaps-max-basal)=

### Максимальное значение ед/ч, на которое можно установить временный базал ("max-basal" OpenAPS)

Эта настройка безопасности определяет максимальную скорость временного базала помпы. Значение должно быть одинаковым и в помпе и AAPS и должно быть не менее чем в 3 раза выше наивысшей базальной скорости.

Пример:

Пример: Самый высокий базал вашего профиля в течение дня составляет 1.00 ед/ч. В этом случае рекомендуется установить максимум не менее 3 ед/ч.

AAPS задает 'жесткий предел' значения в зависимости от возраста пациента, профиль которого выбран в настройках.

AAPS ограничивает эту величину следующим образом:

* Ребенок: 2
* Подросток: 5
* Взрослый: 10
* Инсулинорезистентный взрослый: 12
* Беременная: 25

*See also [overview of hard-coded limits](#overview-of-hard-coded-limits).*

(Open-APS-features-maximum-total-iob-openaps-cant-go-over-openaps-max-iob)=

### Максимальное общее количество активного инсулина IOB, которое не может превысить OpenAPS (OpenAPS "max-iob")

Эта величина определяет максимальное значение активного инсулина IOB, при котором AAPS будет оставаться в режиме замкнутого цикла. Если текущий активный инсулин IOB (например, после болюса на еду) превышает определенную величину, то алгоритм останавливает подачу инсулина до тех пор, пока предел IOB не будет ниже заданного значения.

В алгоритме SMB OpenAPS, max-IOB рассчитывается иначе, чем в мастере болюса AMA. В алгоритме мастера болюса AMA maxIOB был всего лишь параметром безопасности активного базального инсулина IOB, а в SMB-режиме в него также входит активный болюсный инсулин. Рекомендуется для начала установить

    maxIOB = средний болюс на еду + троекратный макс. базал
    

Будьте осторожны и терпеливы и меняйте настройки шаг за шагом. Эта величина для каждого своя, а также зависит от средней общей суточной дозы (TDD). For safety reason, there is a limit, which depends on the patient age. The 'hard limit' for maxIOB is higher than in [AMA](#max-uh-a-temp-basal-can-be-set-to-openaps-max-basal).

* Ребенок: 3
* Подросток: 7
* Взрослый: 12
* Инсулинорезистентный взрослый: 25
* Беременная: 40

*See also [overview of hard-coded limits](#overview-of-hard-coded-limits).*

См. также [документацию OpenAPS по SMB](https://openaps.readthedocs.io/en/latest/docs/Customize-Iterate/oref1.html#understanding-super-micro-bolus-smb).

### Включить autosense помощника болюса AMA

Here, you can choose if you want to use the [sensitivity detection](../DailyLifeWithAaps/SensitivityDetectionAndCob.md) 'autosens' or not.

(Open-APS-features-enable-smb)=

### Включить супер микро болюс SMB

Включите, чтобы использовать функционал SMB. Если отключено, то SMB не вводятся.

### Включить супер микро болюс SMB с высокими значениями временных целей

Если включен этот параметр, SMB будут разрешены, но не обязательно включены, когда действует высокая временная цель (что-либо выше 100 мг/дл независимо от цели профиля). Эта опция нужна для отключения микроболюсов SMB, когда параметр отключен. Например, если эта опция отключена, микроболюсы можно отключить, установив временную цель выше 100mg/dl. Эта опция также отключает SMB независимо от того, какое другое условие пытается включить микроболюс.

Если этот параметр включен, SMB будут включены только с высокой временной целью, если при этом также включены SMB с временными целями.

(Open-APS-функции-включать-микроболюсы-всегда)=

### Всегда включать супер микро болюс SMB

Если включена эта настройка, микроболюсы SMB работают всегда (независимо от активных углеводов COB, временных целей или болюсов). Если этот параметр включен, остальные параметры включения не будут иметь эффекта. Однако, если отключена настройка «Включить SMB с высокими временными целями» и задается высокая временная цель, SMB будут отключены. По соображениям безопасности, эта опция возможна только для источников ГК с хорошей системой фильтрации зашумленных данных. Currently it is only an available option with a Dexcom G5 or G6, if using the ['Build your own Dexcom App'](../CompatibleCgms/DexcomG6.md#if-using-g6-with-build-your-own-dexcom-app) or “native mode” in xDrip+. Если значение ГК имеет слишком большое отклонение, G5/G6 не отправляет его и ожидает следующего значения через 5 минут.

Для других систем мониторинга, таких как Freestyle Libre, функция ‘всегда включать SMB’ будет оставаться неактивной пока в xDrip+ не появится более адекватное расширение для сглаживания данных. You can find more [here](../CompatibleCgms/SmoothingBloodGlucoseData.md).

### Включать супер микро болюсы при активных углеводах COB

Если этот параметр включен, SMB включаются при активных углеводах COB больше 0.

### Включать супер микро болюс SMB с временными целями

Если включена эта настройка, то SMB включаются при наличии любой временной цели (ожидаемый прием пищи, нагрузка, гипо, пользовательский). Если эта настройка включена, но отключено "Включить SMB с высокими временными целями", SMB будут включаться при низком значении цели (менее 100мг/дл), но отключены, если установлена высокая временная цель.

### Активировать супер микро болюс SMB после углеводов

Если это включено, то микроболюсы SMB работают в течение 6 часов после внесения углеводов, даже если значение COB достигло 0. По соображениям безопасности, эта опция возможна только для источников ГК с хорошей системой фильтрации зашумленных данных. Currently it is only an available option with a Dexcom G5 or G6 if using the ['Build your own Dexcom App'](../CompatibleCgms/DexcomG6.md#if-using-g6-with-build-your-own-dexcom-app) or “native mode” in xDrip+. Если значение ГК имеет слишком большое отклонение, G5/G6 не отправляет его и ожидает следующего значения через 5 минут.

Для других систем мониторинга, таких как Freestyle Libre, функция "включать SMB после углеводов" будет оставаться неактивной пока в xDrip+ не появится более адекватное расширение для сглаживания данных. You can find [more information here](../CompatibleCgms/SmoothingBloodGlucoseData.md).

### How frequently SMBs will be given in min

This feature limits the frequency of SMBs. This value determines the minimum time between SMBs. Note that the loop runs every time a glucose value comes in (generally 5 minutes). Subtract 2 minute to give loop additional time to complete. E.g if you want SMB to be given every loop run, set this to 3 minutes.

Default value: 3 min.

(Open-APS-функции-макс-минут-базала-для-ограничения)=

### Верхний лимит минут базала при SMB

Это важный элемент в настройках безопасности. Это значение определяет, сколько микроболюсов SMB может быть подано на основе количества базального инсулина за данное время, когда оно обеспечено активными углеводами COB.

Увеличение этого значения позволяет микроболюсам SMB вести себя более агрессивно. Начать следует со значения по умолчанию в 30 минут. После некоторого опыта, увеличивайте это значение приращениями по 15 минут и наблюдайте за эффектом при многократном приеме пищи.

Рекомендуется не устанавливать это значение выше 90 минут, так как существует вероятность достижения точки, после которой алгоритм не сможет контролировать снижающуюся гликемию при нулевом временном базале 0 ед/ч ('zero-temp'). Следует также установить оповещения о низкой ГК, особенно если вы только тестируете новые настройки.

Значение по умолчанию: 30 мин.

### Включить непредвиденный прием пищи UAM

При включении этой опции алгоритм SMB может распознать непредвиденный прием пищи. Это полезно, если вы забыли сообщить алгоритму AAPS о съеденных углеводах или неверно оценили их количество или съеденное богато жирами и белками и действует дольше чем ожидалось. Без ввода углеводов алгоритм UAM может распознать быстрое увеличение глюкозы, вызванное углеводами, адреналином и т. д., и попытается компенсировать его при помощи микроболюсов SMB. И наоборот: если гликемия падает быстро, то настройка поможет остановить SMB раньше времени.

**Поэтому при использовании микроболюсов SMB всегда следует активировать непредвиденный прием пищи UAM.**

### Sensitivity raises target

If this option is enabled, the sensitivity detection (autosens) can raise the target when sensitivity is detected (below 100%). In this case your target will be raised by the percentage of the detected sensitivity.

### Resistance lowers target

If this option is enabled, the sensitivity detection (autosens) can lower the target when resistance is detected (above 100%). In this case your target will be lowered by the percentage of the detected resistance.

### Высокая врем. цель temptarget повышает чувствительность

Если эта опция включена, то чувствительность инсулина будет увеличена при временной цели более 100 мг/дл или 5.6 ммол/л. Это означает, что чувствительность к инсулину ISF возрастет, в то время как углеводный коэффициент IC и базал уменьшатся. Это сделает поведение алгоритма AAPS менее агрессивным, когда устанавливается высокая временная цель.

### Низкая временная цель temptarget снижает чувствительность

Если эта опция включена, то параметр чувствительность инсулина будет снижен при временной цели ниже 100 мг/дл или 5.6 ммол/л. Это означает, что чувствительность к инсулину ISF снизится, в то время как IC и базал увеличатся. Это сделает поведение алгоритма AAPS более агрессивным, когда устанавливается низкая временную цель.

### Дополнительные настройки

**Всегда использовать короткое среднее изменение (delta) вместо простых данных** Если включить эту функцию, AAPS применяет короткое среднее изменение ГК последних 15 минут, обычно это среднее значение из последних трех. Это помогает AAPS работать более стабильно с такими зашумленными источниками данных, как xDrip+ и Libre.

**Максимальный ежедневный множитель безопасности** Это важный ограничитель безопасности. Настройка по умолчанию (которая вряд ли потребует корректировки) равна 3. Это означает, что алгоритму AAPS ни при каких условиях не будет разрешено устанавливать временный базал, который более чем в 3 раза выше самого высокого почасового базала, запрограммированного в помпе и/или профиле. Пример: если ваш самый высокий базал 1,0 ед/ч, а максимальный ежедневный множитель безопасности 3, то AAPS может установить максимальную временную скорость базала на 3,0 ед./ч. (= 3 x 1,0 ед./ч.).

Значение по умолчанию: 3 (не следует изменять, если нет настоящей потребности и вам не понятно, что вы делаете)

**Текущий множитель безопасности базала** Это важный ограничитель безопасности. Настройка по умолчанию (которая вряд ли потребует корректировки) равна 4. Это означает, что алгоритму AAPS ни при каких условиях не будет разрешено устанавливать временный базал, который более чем в 4 раза выше текущего почасового базала, запрограммированного в помпе и/или профиле.

Значение по умолчанию: 4 (не следует изменять, если нет настоящей потребности и вы не понимаете, что делаете)

* * *

(Open-APS-функции-расширенный-помощник-болюса-ama)=

## Расширенный мастер болюса (AMA)

AMA, сокращение от "advanced meal assist", усовершенствованный помощник болюса, включен в функционал OpenAPS с 2017 года (oref0). Помощник болюса OpenAPS Advanced Meal Assist (AMA) позволяет системе быстрее установить высокое временное целевое значение после болюса на еду, ЕСЛИ вы правильно ввели углеводы.

Подробнее в [Документации OpenAPS](https://newer-docs.readthedocs.io/en/latest/docs/walkthrough/phase-4/advanced-features.html#advanced-meal-assist-or-ama).

(Open-APS-функции-макс-ед-час-для-врем-базала-openaps-max-basal)=

### Максимальное значение ед/ч, на которое можно установить временный базал ("max-basal" OpenAPS)

Эта настройка безопасности помогает AAPS никогда не задавать опасно высокую базальную скорость и ограничивает временный базал до x ед./ч. Рекомендуется установить какое-то разумное значение. Хороший совет – умножить наивысшую скорость базала в вашем профиле на 4 или по меньшей мере на 3. Например, если максимальная скорость базала в вашем профиле установлена на 1 ед./ч, то, умножив ее на 4, вы получите значение 4 ед./ч. и зададите эту величину в качестве параметра безопасности.

Здесь нельзя просто задать любое значение: по причине безопасности есть "жесткий предел", который зависит от возраста пациента. "Жесткий предел" максимального активного инсулина maxIOB в алгоритме помощника болюса AMA ниже, чем в алгоритме SMB. Для детей эта величина самая низкая, а для инсулинарезистентных взрослых - самая большая.

Жесткие ограничители AAPS:

* Ребенок: 2
* Подросток: 5
* Взрослый: 10
* Инсулинорезистентный взрослый: 12
* Беременная: 25

*See also [overview of hard-coded limits](#overview-of-hard-coded-limits).*

### Максимальное общее количество активного инсулина IOB (ед.), которое не может превысить OpenAPS ("max-iob" в OpenAPS)

Этот параметр ограничивает максимальную величину активного базального инсулина IOB, при которой работает алгоритм AAPS. Если активный инсулин IOB выше, то алгоритм AAPS перестает подавать дополнительный базальный инсулин до тех пор, пока базальный IOB не окажется в заданных пределах.

Значение по умолчанию 2, но можно постепенно поднять этот параметр, чтобы посмотреть, как он влияет на вас и какое значение лучше. Эта величина для каждого своя, а также зависит от средней общей суточной дозы (TDD). По соображениям безопасности, существует предел, который зависит от возраста пациента . "Жесткий предел" максимального активного инсулина maxIOB в алгоритме помощника болюса AMA ниже, чем в алгоритме SMB.

* Ребенок: 3
* Подросток: 5
* Взрослый: 7
* Инсулинорезистентный взрослый: 12
* Беременная: 25

*See also [overview of hard-coded limits](#overview-of-hard-coded-limits).*

### Включить autosense помощника болюса AMA

Here, you can chose, if you want to use the [sensitivity detection](../DailyLifeWithAaps/SensitivityDetectionAndCob.md) autosens or not.

### Autosense также подстраивает цели

Если эта опция включена, Autosens может скорректировать цели (наряду с базой и ISF). Это позволяет AAPS работать более/менее «агрессивно». При этом фактическая цель может быть достигнута быстрее.

### Дополнительные настройки

**Всегда использовать короткое среднее изменение (delta) вместо простых данных** Если включить эту функцию, AAPS применяет короткое среднее изменение ГК последних 15 минут, обычно это среднее значение из последних трех. Это помогает AAPS работать более стабильно с такими зашумленными источниками данных, как xDrip+ и Libre.

**Максимальный ежедневный множитель безопасности** Это важный ограничитель безопасности. Настройка по умолчанию (которая вряд ли потребует корректировки) равна 3. Это означает, что алгоритму AAPS ни при каких условиях не будет разрешено устанавливать временный базал, который более чем в 3 раза выше самого высокого почасового базала, запрограммированного в помпе. Пример: если ваш самый высокий базал 1,0 ед/ч, а максимальный ежедневный множитель безопасности 3, то AAPS может установить максимальную временную скорость базала на 3,0 ед./ч. (= 3 x 1,0 ед./ч.).

Значение по умолчанию: 3 (не следует изменять, если нет настоящей потребности и вам не известно, что вы делаете)

**Текущий множитель безопасности базала** Это важный ограничитель безопасности. Настройка по умолчанию (которая вряд ли потребует корректировки) равна 4. Это означает, что алгоритму AAPS ни при каких условиях не будет разрешено устанавливать временный базал, который более чем в 4 раза выше текущего почасового базала, запрограммированного в помпе.

Значение по умолчанию: 4 (не следует изменять, если нет настоящей потребности и вам не известно, что вы делаете)

**Делитель приостановки болюса** Функция «приостановка болюса» работает после болюса на еду. ААPS не задает временный базал на низкой цели после еды на время действия инсулина DIA, поделенное на «делитель приостановки болюса». Значение по умолчанию 2. Это означает, что при продолжительности действия инсулина DIA 5 часов "приостановка болюса" продлится 5ч. : 2 = 2,5 часа.

Значение по умолчанию: 2

* * *

(Функции-Open-APS-обзор-жестких-ограничений)=

## Обзор жестких ограничений

<table border="1">
  
<thead>
  <tr>
    <th width="200"></th>
    <th width="75">ребенок</th>
    <th width="75">Подросток</th>
    <th width="75">взрослый</th>
    <th width="75">Инсулинорезистентный взрослый</th>
    <th width="75">Беременная</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td>MAXBOLUS</td>
    <td>5,0</td>
    <td>10,0</td>
    <td>17 0</td>
    <td>25 0</td>
    <td>60 0</td>
  </tr>
  <tr>
    <td>MINDIA</td>
    <td>5,0</td>
    <td>5,0</td>
    <td>5,0</td>
    <td>5,0</td>
    <td>5,0</td>
  </tr>
  <tr>
    <td>MAXDIA</td>
    <td>9,0</td>
    <td>9,0</td>
    <td>9,0</td>
    <td>9,0</td>
    <td>10,0</td>
  </tr>
  <tr>
    <td>MINIC</td>
    <td>2,0</td>
    <td>2,0</td>
    <td>2,0</td>
    <td>2,0</td>
    <td>0,3</td>
  </tr>
  <tr>
    <td>MAXIC</td>
    <td>100,0</td>
    <td>100,0</td>
    <td>100,0</td>
    <td>100,0</td>
    <td>100,0</td>
  </tr>
  <tr>
    <td>MAXIOB_AMA</td>
    <td>3,0</td>
    <td>5,0</td>
    <td>7,0</td>
    <td>12 0</td>
    <td>25 0</td>
  </tr>
  <tr>
    <td>MAXIOB_SMB</td>
    <td>7,0</td>
    <td>13,0</td>
    <td>22,0</td>
    <td>30,0</td>
    <td>70,0</td>
  </tr>
  <tr>
    <td>MAXBASAL</td>
    <td>2,0</td>
    <td>5,0</td>
    <td>10,0</td>
    <td>12 0</td>
    <td>25 0</td>
  </tr>
</tbody>
</table>