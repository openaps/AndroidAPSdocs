# Подсчет активных углеводов COB

## Как AAPS вычисляет значение COB?

Когда пользователь вводит углеводы во время приема пищи или при коррекции, **AAPS** добавляет это значение к текущему количеству активных углеводов (**COB**). После этого **AAPS** рассчитывает усвоение углеводов на основе наблюдаемых отклонений от значений **ГК пользователя**. Скорость усвоения зависит от коэффициента чувствительности к углеводам (**CSF**). Эта функция не указана в **Профиле**, она рассчитывается алгоритмом **AAPS** в соответствии с настройками **ISF/I:C** и зависит от того, насколько 1 грамм углеводов потребляемой пищи увеличит гликемию **ГК** пользователя.

## Фактор чувствительности к углеводам

Подсчет в **AAPS** ведется по следующей формуле:

- усвоенные углеводы = отклонение * углеводный коэффициент ic / фактор чувствительности к инсулину isf.

При этом на ** Профиль ** пользователя происходит следующее воздействие:

- _повышение _ **IC ** -увеличение усваивамых каждые 5 минут углеводов тем самым уменьшает общее время усвоения;

- _повышение _ **ISF**- уменьшение усваиваемых каждые 5 минут углеводов тем самым продлевает общее время усвоения

- _изменение_ ** процента Профиля** - увеличение/уменьшение обеих величин таким образом не влияет на время усвоения углеводов.

Например, если в **Профиле** пользователя **ISF** равен 100, а углеводный коэффициент **I:C** равен 5, Rоэффициент чувствительности пользователя к углеводам будет равен 20. При каждом увеличении **гликемии** пользоателя на 20 мг/дл (1,1 ммоль/л) **AAPS** считает, что организм поглотил 1 г углеводов. Положительное значение активного инсулина **IOB** также влияет на расчет **COB**. Таким образом, если **AAPS** предсказывает, что **ГК пользователя** снизится на 20 мг/дл  (1,1 ммоль/л) из-за действия активного инсулина **IOB**, а гликемия вместо этого остается неизменной, то  алгоритм **AAPS** будет считать, что усвоен 1 г углеводов.

Усвоение углеводов также будет рассчитываться с помощью методов, описанных ниже, в зависимости от выбора алгоритма чувствительности в настройках **AAPS**.

## Чувствительность к углеводам - Oref1

Непоглощенные углеводы отбрасываются после указанного времени:

![Oref1](../images/cob_oref0_orange_II.png)

![Снимок экрана 2024-10-05 161009](../images/cob_oref0_orange_I.png)


## Чувствительность к углеводам - средневзвешенная

Усвоение принимается из рассчета, что активные углеводы COB = 0 по истечении указанного времени:

![AAPS, средневзвешенное значение](../images/cob_aaps2_orange_II.png)

Если вместо значения, рассчитанного на основе отклонений **ГК**, используется минимальное поглощение углеводов (min_5m_carbimpact), на графике **COB** появится оранжевая точка.

(CobCalculation-detection-of-wrong-cob-values)=
## Обнаружение неправильного значения COB

**AAPS** предупредит пользователя о неверном подсчете углеводов **COB** перед подачей болюса, если  от предыдущего приема пищи остаются активные углеводы **COB**,. В этом случае пользователь получит дополнительную подсказку на экране подтверждения калькулятора болюса.

### Как AndroidAPS обнаруживает неправильные значения активных углеводов COB?

В обычных расчетах __AAPS__ определяет усвоение углеводов по отклонениям **ГК**. В случае, если пользователь ввел углеводы, а **AAPS** не может рассчитать их предполагаемое усвоение по отклонениям **ГК**, то алгоритмом применяется метод [min_5m_carbimpact](#Preferences-min_5m_carbimpact) (так называемый "запасной вариант"). Поскольку этот метод вычисляет только минимальное усвоение углеводов, без учета отклонений **ГК**, то в этом случае возможны некорректные значения активных углеводов COB.

![Подсказка о неверном значении COB](../images/Calculator_SlowCarbAbsorption.png)

На снимке экрана выше 58% времени поглощения углеводов был вычислен математически методом min_5m_carbimpact вместо значения, основанного на отклонениях ГК. Это означает, что на самом деле у пользователя может быть меньше активных углеводов **COB**, чем рассчитывает алгоритм.

### Как относиться к этому предупреждению?

- Подумайте об отмене терапевтического действия - нажмите «Отмена» вместо ОК.
- -Заново рассчитайте свой предстоящий прием пищи с помощью калькулятора болюса, сняв галочку с активных углеводов **COB**.
- Если требуется болюс на коррекцию, введите его вручную.
- Будьте осторожны, не допустиеь передозировки или переизбытка инсулина!


### Почему алгоритм неправильно распознает активные углеводы COB?

Это может быть вызвано тем, что:
- Пользователь мог переоценить количество углеводов при вводе записи.
- После предыдущего приема пищи происходила физическая активность или нагрузка.
- -Углеводный коэффициент I:C нуждается в корректировке.
- Значение для min_5m_carbimpact неверно (рекомендуется 8 для алгоритма SMB, 3 для OpenAPS AMA).


## Ручная коррекция введенных углеводов

Если углеводов слишком много или наоборот недостаточно, это можно исправить с помощью вкладки "Терапия" и вкладки "Действия" / меню, как описано [ здесь](#screens-bolus-carbs).


## Коррекция количества углеводов - как удалить запись из Терапии


Для исправления ошибочной записи об углеводах, можно воспользоваться вкладкой "Терапия", удалив ее оттуда. Это может произойти из-за того, что пользователь переоценил или недооценил количество вводимых углеводов:

![COB_Снимок экрана 2024-10-05 170124](../images/e123d85d-907e-4545-bf1b-09fee4d42555.png)

1. Проверьте и запомните фактическое количество активных углеводов **COB** и активного инсулина **IOB** на главном экране **AAPS**.
2. В зависимости от помпы, углеводы на вкладке "Терапия" могут отображаться на одной строке или в виде отдельной записи (например, на Dana RS).
3. Удалите запись, сначала поставив галочку напротив мусорного ведра в правом верхнем углу (см. Фото выше, шаг 1). Затем отметьте галочкой количество неправильно введенных углеводов (см фото выше, шаг 2). Затем отметьте ‘мусорное ведро’ в правом верхнем углу (повторите шаг 1).
4. Убедитесь, что углеводы удалены успешно, еще раз проверив **COB** на главном экране **AAPS**.
5. Сделайте то же для активного инсулина **IOB**, если на вкладке терапии только одна общая строка для углеводов и инсулина.
6. Если углеводы не удалены должным образом, значение **COB** будет слишком высоким, что может привести к введению слишком большого количества инсулина.
7. Введите правильное количество углеводов с помощью кнопки "Углеводы" на главном экране ** AAPS** и проставьте правильное время события.
8. Если на вкладке "терапия" углеводы и инсулин располагаются на одной строке, также укажите количество инсулина. Убедитесь, что установлено правильное время события, и проверьте количество активного инсулина **IOB** на главном экране после подтверждения новой записи.

