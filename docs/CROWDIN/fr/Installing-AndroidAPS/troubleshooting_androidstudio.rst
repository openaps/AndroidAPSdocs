Устранение неполадок Android Studio
**************************************************
Потеряно хранилище ключей
==================================================
Если вы используете одно и то же хранилище ключей при обновлении AndroidAPS, вам не нужно деинсталлировать предыдущую версию на смартфоне. Поэтому рекомендуется хранилище ключей размещать в надежном месте.

На случай, если вы не можете найти свое старое хранилище ключей, выполните следующие действия:

1. `Экспорт настроек <../Usage/ExportImportSettings.html#how-to-export-settings>`_ на вашем телефоне.
2. Скопируйте настройки вашего телефона во внешнее местоположение (напр. ваш компьютер, служба облачного хранения...).
3. Убедитесь, что файл параметров "Параметры AndroidAPS" сохранен.
4. Сгенерируйте подписанный apk новой версии, как описано на странице обновления <../Instaling-AndroidAPS/Update-to-new-version.html> ` _.
5. Деинсталлируйте предыдущую версию AAPS на вашем телефоне.
6. Установите новую версию AAPS на свой телефон.
7. `Импортируйте настройки <../Usage/ExportImportSettings.html#how-to-export-settings>`_ - если не можете найти их на вашем телефоне, скопируйте их из внешнего хранилища.
8. Продолжайте пользоваться циклом.

Предупреждение компилятора Kotlin
==================================================
Если сборка завершена успешно, но вы получаете предупреждения компилятора Kotlin, просто проигнорируйте эти предупреждения. 

Приложение успешно построено и может быть перенесено на телефон.

.. изображение:: ../images/GIT_WarningIgnore.PNG
  :alt: игнорировать предупреждение компилятора Koline

Ключ создан с ошибками
==================================================
При создании нового хранилища ключей для построения подписанного APK в Windows может появиться следующее сообщение об ошибке

.. изображение:: ../images/AndroidStudio35SigningKeys.png
  :alt: Ключ создан с ошибками

Это, кажется, ошибка в Android Studio 3.5.1 и в среде Java в Windows. Ключ создается правильно, но рекомендация выводится как ошибка. В настоящее время это можно игнорировать.

Не удалось загрузить… / Работа оффлайн
==================================================
Если вы получите подобное сообщение об ошибке

.. изображение:: ../images/GIT_Offline1.jpg
  :alt: Не удалось загрузить предупреждение

убедитесь, что 'Автономная работа' выключена.

Файл -> параметры

.. изображение:: ../images/GIT_Offline2.jpg
  :alt: Параметры автономной работы

Ошибка: buildOutput.apkData не может быть пустым
==================================================
Иногда появляется сообщение об ошибке при компоновке apk

  `Ошибки при сборке APK.`
   
  `Ошибка: buildOutput.apkData не может быть пустым`

Эта известная ошибка в Android Studio 3.5 и, вероятно, она не будет исправлена до Android Studio 3.6. Есть три варианта:

1. Вручную удалите три папки компоновки (обычная "сборка", папка компоновки в "app" и папка компоновки в "wear") и снова сгенерируйте подписанный apk.
2. Установите папку назначения в папку проекта, а не в папку приложения, как описано в этом видео <https://www.youtube.com/watch?v=BWUFWzG-kag>`_.
3. Измените папку назначения apk (другое расположение).

Не удается запустить демон процесс
==================================================
Если вы видите подобное сообщение об ошибке, вы, вероятно, используете ОС Windows 10, 32-bit. Она не поддерживается Android Studio 3.5.1 и выше. В Windows 10 следовать использовать 64-битную операционную систему.

В интернете много руководств, как определить, у вас 32-или 64-битная ОС- например " это <https://www.howtogeek.com/howto/21726/how-do-i-know-if-im-running-32-bit-or-64-bit-windows-answers/>` _.

.. изображение:: ../images/AndroidStudioWin10_32bitError.png
  :alt: снимок экрана не удалось запустить процесс демона
  

Нет данных CGM мониторинга
==================================================
* В случае, если вы используете xDrip+: идентифицируйте ресивер, как описано в настройках xDrip+ <../Configuration/xdrip.html#identify-receiver>`_.
ContextEdit.
* Если вы используете Dexcom G6 с ` модифицированным приложением Dexcom app <../Hardware/DexcomG6.html#if-using-g6-with-patched-dexcom-app> ` _, вам понадобится версия из папки ` 2.4 <https://github.com/dexcomapp/dexcomapp/tree/master/2.4>` _.

Неодобренные изменения
==================================================
Если вы получите сообщение об ошибке, как это

.. изображение:: ../images/GIT_TerminalCheckOut0.PNG
  :alt: отказ: незафиксированные изменения

Вариант 1 - Проверить установку git
--------------------------------------------------
* возможно, git установлен неправильно (должен быть доступен по всему миру)
* после установки Git в Windows и, нужно перезапустить компьютер или хотя бы раз выйти и снова войти в систему, чтобы сделать git глобально доступным
* `Проверьте установку git <../Installing-AndroidAPS/git-install.html#check-git-settings-in-android-studio>`_
* Если на вашем компьютере не отображается версия gti, но git установлен, убедитесь, что Android Studio знает, где находится `git. /Installing-AndroidAPS/git-install.html#set-git-path-in-android-studio>`_ на своем компьютере.

Вариант 2 - Перезагрузка исходного кода
--------------------------------------------------
* В Android Studio выберите VCS -> GIT -> Сбросить HEAD

.. изображение:: ../images/GIT_TerminalCheckOut3.PNG
  :alt: Сбросить HEAD
   
Вариант 3 - проверить наличие обновлений
--------------------------------------------------
* Скопируйте «git checkout --» в буфер обмена (без кавычек)
* Переключитесь на терминал в Android Studio (слева с нижней стороны окна Android Studio)

  .. изображение:: ../images/GIT_TerminalCheckOut1.PNG
  :alt: Терминал Android Studio
   
* Вставьте скопированный текст и нажмите ввод

  .. изображение:: ../images/GIT_TerminalCheckOut2.PNG
    :alt: Проверка GIT успешно завершена

Приложение не установлено
==================================================
.. изображение:: ../images/Update_AppNotInstalled.png
  :alt: приложение не установлено

* Убедитесь, что вы передали файл «full-release.apk» на ваш телефон.
* Если на вашем телефоне появилось сообщение "приложение не установлено", то выполните следующее:
  
1. `Экспортируйте параметры <../Usage/ExportImportSettings.html>`_ (в версии AAPS, уже установленной на телефоне)
2. Удалите AAPS с телефона.
3. Включите режим полета и выключите Bluetooth.
4. Установите новую версию («app-full-release.apk»)
5. `Импортируйте настройки <../Usage/ExportImportSettings.html>`_
6. Снова включите Bluetooth и отключите режим самолета

Приложение установлено, но старая версия
==================================================
Если вы успешно построили приложение, перенесли его на телефон и установили его, но номер версии остается прежним, то вы могли пропустить шаг обновления `update your local copy <../Update-to-new-version.html#update-your-local-copy>`.

Ничего из вышеперечисленного не сработало
==================================================
Если вышеперечисленные советы не помогли попробуйте начать сборку приложения с нуля:

1. `Экспортируйте параметры <../Usage/ExportImportSettings.html>`_ (в версии AAPS, уже установленной на телефоне)
2. Подготовьте пароль ключа и пароль хранилища
    В случае, если вы забыле пароли, вы можете попытаться найти их в файлах проекта, как описано здесь <https://youtu.be/nS3wxnLgZOo>` _. Или просто создайте новый файл хранения ключей. 
3. Постройте приложение с нуля, как описано `здесь <../Installing-AndroidAPS/Building-APK.html#download-code-and-additional-components>`_.
4.	Когда вы успешно собрали APK, удалите существующее приложение с телефона, перенесите новое приложение на ваш телефон и установите.
5. `Импортируйте настройки <../Usage/ExportImportSettings.html>`_

Сценарий худшего варианта
==================================================
Если даже создание приложения с нуля не решает проблему, попробуйте полностью удалить Android Studio. Некоторые пользователи сообщили, что это решило проблему.

** Обязательно деинсталлируйте все файлы, связанные с Android Studio. * * Если вы не полностью удалите Android Studio со всеми скрытыми файлами, деинсталляция может привести к новым проблемам, а не к решению существующих. Руководства по полной деинсталляции можно найти в Интернете, напр. <https://stackoverflow.com/questions/39953495/how-to-completely-uninstall-android-studio-from-windowsv10>.

Установите Android Studio с нуля, как описано ниже: <../Installing-AndroidAPS/Building-APK.html#install-android-studio>`_ и **не обновляйте gradle**.
